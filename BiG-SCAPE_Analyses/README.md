# BiG-SCAPE Analyses

This folder contains scripts, run commands, and results for **BiG-SCAPE** analyses. BiG-SCAPE clusters antiSMASH-predicted BGCs into Gene Cluster Families (GCFs) and is used as the basis for GCF-centric analyses and for BiG-MAP input. For info on scripts / data for plots, please have a look at the `Figures/Figure_4/` folder.

## Overview

BiG-SCAPE was run on antiSMASH BGC predictions from EPIC skin isolate genomes and genomes/metagenome-assembled genomes from the SMGC with MIBiG reference BGCs requested for inclusion. This directory holds the run command, clustering results (mix mode, cutoff 0.30), Python scripts that build BGC- and GCF-centric summary tables, and a small MIBiG parsing script for activity annotations.

## Files and Scripts

### Run command
- **`bigscape.cmd`**  
  Example command used to run BiG-SCAPE. It:
  - Reads antiSMASH output from an input directory (`-i`)
  - Writes to `BiG-SCAPE_Results_V2` (`-o`)
  - Uses Pfam (`--pfam_dir`) and MIBiG (`--mibig`)
  - Uses cutoff 30% (`-c 30`), `--include_singletons`, and `--mix` for mixed clustering.  
  Paths are environment-specific; update for your setup.

### Python scripts (BGC/GCF processing)
- **`processBGCsAndGCFs.py`**  
  Builds a **BGC-centric** table: one row per BGC with sample (EPIC/SMGC/MIBiG), GCF membership, taxonomy (genus/species), BGC class, contig edge, size, and product info.  
  - **Inputs (hardcoded paths):**  
    `All_BGC_Genbanks.txt`, `bigscape_mix_results/mix_clustering_c0.30.tsv`, `SMGC_Taxa_Info.txt`, `LK_Taxa_Info.txt`, `Dereplication_Results_99.txt`  
  - **Output:** Printed to stdout; typically redirected to **`BGC_Centric_View.txt`**.

- **`processGCFsAndBGC.py`**  
  Builds a **GCF-centric** table: one row per GCF with major BGC class, major genus, annotation/taxonomy summaries, median BGC length, number of BGCs, and counts of BGCs from the EPIC, SMGC, and MIBiG sources. Only GCFs that contain at least one EPIC or SMGC BGC are printed.  
  - **Inputs:** Same as above.  
  - **Output:** Printed to stdout; typically redirected to **`GCF_Centric_View.txt`**.

Run from this directory so that relative paths in the scripts resolve correctly.

### MIBiG parsing
- **`MIBiG_Parsing/getListOfMIBiGBGCsWithAntifugalAndAntibacterial.py`**  
  Parses MIBiG JSON files in `mibig_json_3.1/` for antifungal/antibacterial activity and cross-references with **`BGC_Centric_View.txt`** and **`LK_GCFs.txt`** to list MIBiG BGCs in EPIC-associated GCFs that have antifungal or antibacterial activity.  
  - **Output:** Prints BGC ID, GCF, and antibacterial/antifungal flags.

## Data and result files

### Clustering (mix mode)
- **`bigscape_mix_results/mix_clustering_c0.30.tsv`**: 
  BGC â†’ GCF assignment (cutoff 0.30).

### BGC/GCF views (generated by scripts above)
- **`BGC_Centric_View.txt`**  
  BGC-centric table (sample, source, derep status, BGC ID, contig edge, size, product, GCFs, genus, species).
- **`GCF_Centric_View.txt`**  
  GCF-centric table (GCF, major class, major genus, annotation/taxonomy summaries, median length, counts, EPIC/SMGC/MIBiG counts).

### Reference and taxonomy
- **`All_BGC_Genbanks.txt`**  
  Listing of BGC GenBank paths per sample (used by the processing scripts).
- **`LK_Taxa_Info.txt`**  
  Taxonomy (e.g. genus, species) for EPIC isolate genomes.
- **`SMGC_Taxa_Info.txt`**  
  Taxonomy for SMGC genomes.
- **`Dereplication_Results_99.txt`**  
  List of EPIC isolate genomes in the 99% dereplication set.

### GCF subsets and uniqueness
- **`LK_GCFs.txt`**
  GCFs that contain at least one BGC from an EPIC genome.
- **`SMGC_GCFs.txt`**
  GCFs that contain at least one BGC from an SMGC genome/MAG.
- **`MIBIG_GCFs.txt`**
  GCFs that contain at least one MIBiG BGC.
- **`LK_SMGC_GCFs.txt`**
  GCFs containing both BGCs from EPIC and SMGC genomes.
- **`Unique_LK_not_in_SMGC.txt`**
  EPIC-specific GCF that is not in SMGC.
- **`Unique_LK_not_in_SMGC_nor_MIBiG.txt`**
  EPIC-specific GCF and not in SMGC or MIBiG.

### Logs
- **`bigscape_logs/`**  
  Run logs (e.g. `runtimes.txt`, `parameters.txt`, `no_biosynthetic_genes_list.txt`).

## BiG-SCAPE Workflow for Reproduction

1. Run BiG-SCAPE using (or adapting) `bigscape.cmd`
2. Referencing the resulting directory, then run (adapting input file paths as needed):
   - `python processBGCsAndGCFs.py > BGC_Centric_View.txt`
   - `python processGCFsAndBGC.py > GCF_Centric_View.txt`

## Dependencies

- **BiG-SCAPE** (with Pfam and MIBiG as in the command).
- Python 3 with **Biopython** for parsing GenBank in `processBGCsAndGCFs.py` and `processGCFsAndBGC.py`.
- Paths in `bigscape.cmd` and in the Python scripts must be set for your environment.
